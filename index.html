<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–∞—Ä—Ç–∞ –ì—Ä–∏–±—Å–∫–æ–≥–æ</title>
    <style>
        :root {
            --bg-color: #f0f0f0;
            --card-bg: #ffffff;
            --text-main: #333333;
            --text-muted: #666666;
            --accent-color: #43a047;
        }

        body { 
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; 
            background: var(--bg-color); 
            margin: 0; 
            padding: 15px; 
            display: flex; 
            justify-content: center; 
            min-height: 100vh;
        }

        .container { 
            background: var(--card-bg); 
            width: 100%; 
            max-width: 700px; 
            padding: 25px; 
            border-radius: 20px; 
            box-shadow: 0 10px 25px rgba(0,0,0,0.1); 
            box-sizing: border-box;
            align-self: flex-start;
        }

        h1 { margin-top: 0; color: #222; font-size: 24px; }
        
        #desc { 
            font-size: 17px; 
            line-height: 1.6; 
            color: var(--text-main); 
            margin-bottom: 20px; 
            white-space: pre-line; 
        }

        .media-wrapper { 
            position: relative; 
            width: 100%; 
            border-radius: 12px; 
            overflow: hidden; 
            background: #000; 
            margin: 15px 0; 
        }

        .media-wrapper iframe { 
            position: absolute; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            border: 0; 
        }


        .video-wrapper { padding-top: 56.25%; display: none; }
        

        .map-wrapper { padding-top: 56.25%; }


        @media (max-width: 480px) {
            body { padding: 10px; }
            .container { padding: 20px; border-radius: 15px; }
            h1 { font-size: 22px; }
            .map-wrapper { padding-top: 100%; } 
        }


        #welcome-screen, .error-block { text-align: center; padding: 40px 10px; }
        .nfc-icon { font-size: 70px; margin-bottom: 20px; display: block; }
        
        .hidden { display: none !important; }

        .btn-retry {
            display: inline-block;
            margin-top: 20px;
            padding: 10px 20px;
            background: var(--accent-color);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-weight: bold;
        }
    </style>
</head>
<body>

<div class="container">
    <div id="welcome-screen" class="hidden">
        <span class="nfc-icon">üì±‚ú®</span>
        <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h1>
        <p>–ß—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ–±—ä–µ–∫—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, <strong>–ø—Ä–∏–ª–æ–∂–∏—Ç–µ —Ç–µ–ª–µ—Ñ–æ–Ω –∫ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–µ–π –í–∞—Å —Ç–æ—á–∫–µ</strong> –Ω–∞ –∫–∞—Ä—Ç–µ.</p>
    </div>

    <div id="content-area" class="hidden">
        <h1 id="title">–ó–∞–≥—Ä—É–∑–∫–∞...</h1>
        <div id="desc"></div>

        <div id="media-container">
            <div id="video-block" class="media-wrapper video-wrapper">
                <iframe id="video-frame" src="" allow="clipboard-write; autoplay" allowFullScreen></iframe>
            </div>

            <div class="media-wrapper map-wrapper">
                <iframe id="map-frame" src=""></iframe>
            </div>
        </div>

        <div id="error-message" class="hidden">
        </div>
    </div>
</div>

<script>
    async function init() {
        const params = new URLSearchParams(window.location.search);
        const mapId = params.get('map');

        const welcomeScreen = document.getElementById('welcome-screen');
        const contentArea = document.getElementById('content-area');
        const mediaContainer = document.getElementById('media-container');
        const errorMessage = document.getElementById('error-message');

        if (!mapId) {
            welcomeScreen.classList.remove('hidden');
            return;
        }

        contentArea.classList.remove('hidden');

        try {
            const response = await fetch('data.json');
            if (!response.ok) throw new Error("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å data.json");
            
            const locations = await response.json();
            const data = locations[mapId];

            if (data) {

                document.getElementById('title').innerText = data.title;
                document.getElementById('desc').innerText = data.description;
                document.getElementById('map-frame').src = data.mapUrl;


                const videoBlock = document.getElementById('video-block');
                const videoFrame = document.getElementById('video-frame');
                
                if (data.videoUrl && data.videoUrl.trim() !== "") {
                    videoFrame.src = data.videoUrl;
                    videoBlock.style.display = 'block';
                } else {
                    videoBlock.style.display = 'none';
                }

                document.title = data.title;
            } else {

                showError("–û–π, —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫..", "–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä–∏–ª–æ–∂–∏—Ç—å —Ç–µ–ª–µ—Ñ–æ–Ω –µ—â–µ —Ä–∞–∑, –∞ –µ—Å–ª–∏ –æ—à–∏–±–∫–∞ –ø–æ–≤—Ç–æ—Ä–∏—Ç—Å—è, –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä—é.");
            }
        } catch (e) {
            console.error(e);
            showError("–û—à–∏–±–∫–∞ —Å–∏—Å—Ç–µ–º—ã", "–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ.");
        }

        function showError(title, text) {
            document.getElementById('title').innerText = title;
            document.getElementById('desc').innerText = text;
            mediaContainer.classList.add('hidden'); 
            errorMessage.classList.remove('hidden'); 
        }
    }

    init();
</script>

</body>
</html>